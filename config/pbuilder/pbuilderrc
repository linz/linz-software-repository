### PATHS
BUILDRESULT=$(dirname $(pwd))
HOOKDIR=~/.pbuilder/hooks


### CONFIGURATION
# Mirrors to use. Update these to your preferred mirror.
DEBIAN_MIRROR="ftp.sk.debian.org"
UBUNTU_MIRROR=$(curl http://mirrors.ubuntu.com/mirrors.txt | head -1 | sed "s/^http:\/\///g" | sed "s/\/ubuntu\/$//g")

EXTRAPACKAGES="${EXTRAPACKAGES}
    apt-transport-https
    ca-certificates
    devscripts
    gnupg
    lintian
    patchutils
    vim-tiny
    openssh-client"

ALLOWUNTRUSTED=yes


# Codenames for Debian suites according to their alias. Update these when
# needed.
UNSTABLE_CODENAME="sid"
TESTING_CODENAME="jessie"
STABLE_CODENAME="wheezy"
STABLE_BACKPORTS_SUITE="$STABLE_CODENAME-backports"

# List of Debian suites.
DEBIAN_SUITES=($UNSTABLE_CODENAME
    $TESTING_CODENAME
    $STABLE_CODENAME
    "unstable"
    "testing"
    "stable")

# List of Ubuntu suites. Update these when needed.
UBUNTU_SUITES=("xenial"
    "wily"
    "vivid"
    "utopic"
    "trusty"
    "saucy"
    "raring"
    "quantal"
    "precise"
    "oneiric"
    "natty"
    "lucid"
    "hardy")


### AUTODETECTION
# Optionally set a default distribution if none is used. Note that you can set
# your own default (i.e. ${DIST:="unstable"}).
: ${DIST:="$(lsb_release --short --codename)"}

# Optionally change Debian codenames in $DIST to their aliases.
case "$DIST" in
    $UNSTABLE_CODENAME)
        DIST="unstable"
        ;;
    $TESTING_CODENAME)
        DIST="testing"
        ;;
    $STABLE_CODENAME)
        DIST="stable"
        ;;
esac

# Optionally set the architecture to the host architecture if none set. Note
# that you can set your own default (i.e. ${ARCH:="i386"}).
: ${ARCH:="$(dpkg --print-architecture)"}


### BUILD
BASETGZ="/var/cache/pbuilder/$DIST-$ARCH-base.tgz"
APTCACHE="/var/cache/pbuilder/$DIST-$ARCH/aptcache/"
BUILDPLACE="/var/cache/pbuilder/build/"

if $(echo ${DEBIAN_SUITES[@]} | grep -q $DIST); then
    # Debian configuration
    MIRRORSITE="http://$DEBIAN_MIRROR/debian/"
    COMPONENTS="main contrib non-free"

    if $(echo "$STABLE_CODENAME stable" | grep -q $DIST); then
        EXTRAPACKAGES="$EXTRAPACKAGES debian-backports-keyring"
        OTHERMIRROR="$OTHERMIRROR | deb http://backports.debian.org/debian $STABLE_BACKPORTS_SUITE $COMPONENTS"
    fi

elif $(echo ${UBUNTU_SUITES[@]} | grep -q $DIST); then
    # Ubuntu configuration
    MIRRORSITE="http://$UBUNTU_MIRROR/ubuntu/"
    COMPONENTS="main restricted universe multiverse"

else
    echo "Unknown distribution: $DIST"
    exit 1
fi

DEBOOTSTRAPOPTS=("--arch" "$ARCH" "${DEBOOTSTRAPOPTS[@]}")
DISTRIBUTION="$DIST"


export DIST ARCH
